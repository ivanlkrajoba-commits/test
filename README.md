# Проект: приложение для обучения детей английскому языку

## Цели
Создать интерактивное приложение, которое помогает детям учить английские слова и фразы через карточки, сопровождаемые озвучкой, изображениями и системой прогресса. Приложение содержит «детский» интерфейс и отдельную админку для взрослых.

## Основные пользовательские роли
- **Ребёнок** – просматривает уроки и карточки, слушает озвучку, открывает переводы, отслеживает прогресс.
- **Взрослый (администратор/родитель)** – создаёт уроки, добавляет карточки, загружает изображения, управляет озвучкой и переводами.

## Структура приложения
```
app/
├── admin/                         # Админ-панель для взрослых
│   ├── lessons/                   # Управление уроками
│   │   ├── LessonListPage
│   │   ├── LessonFormPage         # Создание/редактирование урока
│   │   └── LessonDetailsPage      # Просмотр карточек урока
│   ├── cards/                     # Управление карточками внутри уроков
│   │   ├── CardFormPage           # Добавление/редактирование карточки
│   │   └── CardBulkUploadPage     # Массовая загрузка слов/фраз
│   └── media/                     # Управление изображениями/озвучкой
│       ├── ImageUploadWidget
│       └── AudioGenerationWidget
├── child/                         # Интерфейс для ребёнка
│   ├── HomePage                   # Стартовая страница с кнопками «Изучай!» и т.п.
│   ├── LessonListPage             # Список уроков
│   └── LessonPlayerPage           # Режим изучения карточек
│       ├── Flashcard              # Компонент карточки слова/фразы
│       ├── AudioButton            # Кнопка озвучки
│       └── ProgressIndicator      # Индикатор прогресса «карточка Y из X»
├── shared/                        # Общие компоненты, стили и утилиты
│   ├── components/
│   │   ├── Button
│   │   ├── Modal
│   │   └── CarouselControls
│   ├── hooks/
│   ├── contexts/
│   └── services/
│       ├── apiClient.ts           # Работа с API
│       ├── textToSpeechService.ts # Генерация озвучки
│       └── visionService.ts       # Распознавание изображений
└── assets/
    ├── images/
    └── audio/

backend/
├── api/
│   ├── auth/                      # Аутентификация для взрослых/детей
│   ├── lessons/                   # CRUD для уроков
│   ├── cards/                     # CRUD для карточек
│   ├── uploads/                   # Приём изображений и аудио
│   └── progress/                  # Сохранение прогресса ребёнка
├── services/
│   ├── storageService.js          # Хранение файлов (S3, GCS и т.д.)
│   ├── ttsService.js              # Интеграция с TTS API
│   └── visionService.js           # Интеграция с ML для распознавания
├── models/                        # Модели данных (Lesson, Card, Progress)
└── db/
    ├── migrations/
    └── seeders/

docs/
├── user-flows.md                  # Диаграммы и описания сценариев
├── ui-wireframes/                 # Макеты экранов
└── api-contract.md                # Swagger/OpenAPI

tests/
├── unit/
├── integration/
└── e2e/
```

## Структура меню
1. **Главный экран**
   - Кнопка «Изучай!» (для детей)
   - Кнопка «Админка» (для взрослых)
   - Дополнительные пункты (например, «Настройки», «Профиль родителя»)

2. **Режим ребёнка**
   - Страница списка уроков (карточки уроков с прогрессом)
   - Страница урока (последовательный просмотр карточек)
     - Карточка отображает слово/фразу, изображение, две кнопки: «Озвучить» и «Перевернуть»
     - По нажатию на карточку показывается перевод
     - Навигация вперёд/назад по карточкам, индикатор «карточка Y из X»
     - При завершении урока — экран поздравления и общий прогресс

3. **Админка**
   - Список уроков (CRUD: создать, редактировать, удалять)
   - Внутри урока — список карточек
     - Кнопка «Добавить карточку»
     - Возможность массовой загрузки слов/фраз (CSV/Excel) с автосозданием карточек
     - Для каждой карточки: поле слова/фразы на английском, перевод, изображение, опциональный пример
     - Кнопка «Сгенерировать озвучку» или загрузка собственного аудио
   - Модуль загрузки изображений (drag-and-drop, предпросмотр)

## Основные сущности данных
- **Lesson (Урок)**
  - id, title, description, level, coverImage, order
- **Card (Карточка)**
  - id, lessonId, term (английское слово/фраза), translation, imageUrl, audioUrl, exampleSentence, order
- **Progress (Прогресс)**
  - id, childId, lessonId, currentCardIndex, completed, updatedAt
- **User (Пользователь)**
  - id, role (child/parent), credentials/профиль

## API (черновой контракт)
- `POST /admin/lessons` – создать урок
- `GET /admin/lessons` – список уроков
- `PATCH /admin/lessons/{id}` – обновить урок
- `DELETE /admin/lessons/{id}` – удалить урок
- `POST /admin/lessons/{id}/cards` – добавить карточку
- `POST /admin/lessons/{id}/cards/bulk-upload` – массовая загрузка
- `PATCH /admin/cards/{id}` – обновить карточку
- `DELETE /admin/cards/{id}` – удалить карточку
- `POST /admin/cards/{id}/media/image` – загрузка изображения
- `POST /admin/cards/{id}/media/audio` – загрузка/генерация озвучки
- `GET /child/lessons` – список уроков с прогрессом
- `GET /child/lessons/{id}` – карточки урока
- `POST /child/lessons/{id}/progress` – обновление прогресса

## Ключевые сценарии
1. **Создание урока** – взрослый заходит в админку, нажимает «Создать урок», заполняет название/описание, загружает обложку.
2. **Добавление карточек** – внутри урока взрослый добавляет слова/фразы, перевод, изображение. Возможна массовая загрузка файла, а также автоматическое распознавание изображения и генерация подсказок.
3. **Использование режима «Изучай!»** – ребёнок выбирает урок, просматривает карточки по очереди, слушает озвучку, переворачивает карточку для просмотра перевода. Навигация стрелками или свайпами.
4. **Отслеживание прогресса** – приложение сохраняет, на какой карточке остановился ребёнок, отображает прогресс по уроку и общую статистику.

## Технологические заметки
- **Фронтенд**: React/Vue + TypeScript; компонентная библиотека для UI (например, Chakra UI, Tailwind UI).
- **Бэкенд**: Django (реализовано в директории `backend/`) + PostgreSQL/SQLite в качестве хранилища данных. Для продакшена рекомендуется S3-совместимое файловое хранилище.
- **Медиа**: Интеграция с TTS (Yandex SpeechKit, Google TTS) и сервисом распознавания изображений (Vision API) для автоматического подбора слов.
- **Инфраструктура**: Docker, CI/CD, хранение секретов, мониторинг.

## Реализованный Django-бэкенд

В директории [`backend/`](backend/) находится рабочий проект Django со следующими возможностями:

- модели `Lesson`, `Card` и `StudyProgress` обеспечивают хранение уроков, карточек с изображениями/аудио и прогресса ребёнка;
- админ-панель Django позволяет взрослым создавать уроки и карточки, загружать медиафайлы и отслеживать прогресс;
- REST-эндпоинты под префиксом `/api/` закрывают основные сценарии:
  - `GET /api/lessons/` – список уроков для детского режима (можно указать `?profile=<id>` для получения прогресса);
  - `GET /api/lessons/<id>/cards/` – карточки выбранного урока (также поддерживает `?profile=<id>`);
  - `GET/POST /api/lessons/<id>/progress/` – чтение и обновление прогресса ребёнка;
  - `GET/POST /api/admin/lessons/` и `GET/PUT/DELETE /api/admin/lessons/<id>/` – управление уроками;
  - `GET/POST /api/admin/lessons/<id>/cards/` и `GET/PUT/DELETE /api/admin/cards/<id>/` – управление карточками.

### Как запустить локально

```bash
pip install -r requirements.txt
cd backend
python manage.py migrate
python manage.py createsuperuser  # при необходимости
python manage.py runserver
```

После запуска админка будет доступна на `http://127.0.0.1:8000/admin/`, а API – под `http://127.0.0.1:8000/api/`.

## Фронтенд (React + Vite)

В директории [`frontend/`](frontend/) находится приложение на React с использованием Vite и TypeScript.

### Страницы и ключевые сценарии

- **Главная (`/`)** – приветствует пользователя и даёт выбор между режимами «Изучай!» и «Админка».
- **Список уроков для ребёнка (`/study`)** – подгружает уроки через `GET /api/lessons/` и показывает прогресс конкретного профиля ребёнка (ID сохраняется в `localStorage`).
- **Проигрыватель карточек (`/study/lessons/:id`)** – отображает карточки, озвучку, кнопку «Перевернуть» и индикатор «карточка Y из X». Прогресс автоматически отправляется в бекенд через `POST /api/lessons/<id>/progress/`.
- **Админка – список уроков (`/admin`)** – позволяет создавать уроки через `POST /api/admin/lessons/` и переходить к карточкам.
- **Админка – карточки урока (`/admin/lessons/:id`)** – показывает таблицу карточек и форму добавления новой карточки (`POST /api/admin/lessons/<id>/cards/`).

### Установка зависимостей и запуск

```bash
cd frontend
npm install
npm run dev
```

Vite поднимает фронтенд на `http://127.0.0.1:5173`. Для локальной разработки настроен прокси `/api → http://127.0.0.1:8000`, поэтому запросы фронтенда автоматически уходят в Django без проблем с CORS. В production можно задать переменную окружения `VITE_API_BASE_URL`, чтобы фронт обращался к нужному домену бекенда.

Собрать production-версию:

```bash
npm run build
```

Сгенерированные файлы попадут в каталог `frontend/dist/` и могут быть отданы Django (например, через `collectstatic`).

## Следующие шаги
1. Подготовить прототип UI (wireframes) для детского режима и админки.
2. Определить требования к аутентификации и ролям пользователей.
3. Реализовать интеграцию с сервисами озвучки и распознавания изображений.
4. Добавить массовый импорт карточек и генерацию медиа.
